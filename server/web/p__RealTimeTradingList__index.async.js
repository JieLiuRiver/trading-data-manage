"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[830],{89380:function(ue,O,o){var Q=o(67294),g=o(85893),G=(0,Q.memo)(function(D){var J=D.direction,E=D.size,q=J==="vertical"?{height:E}:{width:E};return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{"data-testid":"space",style:q})})});O.Z=G},76550:function(ue,O,o){o.r(O),o.d(O,{default:function(){return nt}});var Q=o(97857),g=o.n(Q),G=o(19632),D=o.n(G),J=o(5574),E=o.n(J),q=o(98631),u=o(67294),de=o(12444),re=o.n(de),ce=o(72004),oe=o.n(ce),ve=o(9783),L=o.n(ve),fe=function(){function n(){re()(this,n),L()(this,"data",[])}return oe()(n,[{key:"enqueue",value:function(t){this.data.push(t)}},{key:"dequeue",value:function(){return this.data.shift()}},{key:"peek",value:function(){return this.data[0]}},{key:"isEmpty",value:function(){return this.data.length===0}},{key:"size",value:function(){return this.data.length}}]),n}(),he=fe,A;(function(n){n.Pending="pending",n.Running="running"})(A||(A={}));var N;(function(n){n.Finished="Finished",n.InProgress="in-progress"})(N||(N={}));var me=function(){function n(e){re()(this,n),L()(this,"pendingMessageList",new he),L()(this,"rowId",void 0),L()(this,"rowForceUpdate",void 0),L()(this,"cellForceUpdates",{}),L()(this,"status",A.Pending),L()(this,"current",void 0),this.rowId=e}return oe()(n,[{key:"append",value:function(t){var r;this.pendingMessageList.enqueue(t),!this.pendingMessageList.isEmpty()&&((r=this.current)===null||r===void 0?void 0:r.status)!==N.InProgress&&this.run()}},{key:"setRowForceUpdate",value:function(t){this.rowForceUpdate=t}},{key:"pushCellForceUpdates",value:function(t,r){this.cellForceUpdates[t]=r}},{key:"handleBlinkEnd",value:function(){var t,r=this;this.current&&(this.current.status=N.Finished),(t=this.rowForceUpdate)===null||t===void 0||t.call(this),setTimeout(function(){var c,l;r==null||(c=r.current)===null||c===void 0||(l=c.resolve)===null||l===void 0||l.call(c)},20)}},{key:"run",value:function(){var t=this;return new Promise(function(r){var c;t.status=A.Running,t.current={message:t.pendingMessageList.dequeue(),status:N.InProgress,resolve:function(h){var p;!t.pendingMessageList.isEmpty()&&((p=t.current)===null||p===void 0?void 0:p.status)!==N.InProgress?t.run():(t.status=A.Pending,t.current=void 0,r(h))}},(c=t.rowForceUpdate)===null||c===void 0||c.call(t),Object.values(t.cellForceUpdates).forEach(function(l){return l==null?void 0:l()})})}}]),n}(),ge=function(){var e=new Map;return function(t){var r=e.get(t);return r||(r=new me(t),e.set(t,r)),r}},ie=ge(),rt=null,pe=o(66853),i=o(85893),xe=(0,u.memo)(function(n){var e=n.size,t=e===void 0?24:e,r=n.color;return(0,i.jsx)("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9429",width:t,height:t,fill:r,children:(0,i.jsx)("path",{d:"M63.6 489.6h896.7v44.8H63.6z","p-id":"9430"})})}),ye=xe,Ce=(0,u.memo)(function(n){var e=n.size,t=e===void 0?24:e,r=n.color;return(0,i.jsx)("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8939",width:t,height:t,fill:r,children:(0,i.jsx)("path",{d:"M859.062857 256l-170.788571 20.48a6.948571 6.948571 0 0 0-4.022857 11.702857l50.834285 49.005714-193.462857 193.828572-87.405714-87.405714a13.897143 13.897143 0 0 0-19.382857 0l-275.748572 275.748571a7.314286 7.314286 0 0 0 0 9.874286L197.851429 768a6.948571 6.948571 0 0 0 9.508571 0l237.348571-236.982857 87.04 87.04a14.262857 14.262857 0 0 0 19.382858 0l232.594285-232.594286 50.834286 50.834286a6.948571 6.948571 0 0 0 11.702857-4.022857l20.48-170.788572a6.582857 6.582857 0 0 0-7.68-5.485714z","p-id":"8940"})})}),Te=Ce,Re=(0,u.memo)(function(n){var e=n.size,t=e===void 0?24:e,r=n.color;return(0,i.jsx)("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9719",width:t,height:t,fill:r,children:(0,i.jsx)("path",{d:"M866.742857 762.148571l-20.48-170.788571a6.948571 6.948571 0 0 0-11.702857-4.022857l-50.834286 51.2-232.594285-232.594286a14.262857 14.262857 0 0 0-19.382858 0l-87.04 87.04L207.36 256a6.948571 6.948571 0 0 0-9.508571 0L159.085714 294.765714a6.948571 6.948571 0 0 0 0 9.508572l275.748572 276.114285a13.531429 13.531429 0 0 0 19.382857 0l87.405714-87.405714 193.828572 193.828572-50.834286 50.834285a6.948571 6.948571 0 0 0 4.022857 11.702857l170.422857 20.48a6.582857 6.582857 0 0 0 7.68-7.68z","p-id":"9720"})})}),we=Re,_={UpIcon:Te,DownIcon:we,StableIcon:ye},ee=o(46930),Se=o(75081),Me=o(32983),ke=o(32397),je=o(59068),Pe=o(96549),Ue=o(30381),Ee=o.n(Ue);function be(n){var e=String(n),t=e.split("."),r=E()(t,2),c=r[0],l=r[1],h=l===void 0?"":l;return c.replace(/\B(?=(\d{3})+$)/g,",")+(h?"."+h:"")}function ot(n){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",r=n;r>0;--r)t+=e[Math.floor(Math.random()*e.length)];return t}var B=(0,u.memo)(function(e){var t=e.value,r=e.copyable,c=r===void 0?!1:r,l=e.format,h=l===void 0?"YYYY-MM-DD HH:mm":l,p=e.isTime,m=p===void 0?!1:p,w=e.tooltip,j=w===void 0?!0:w,S=e.isNum,M=S===void 0?!1:S,C=e.linkStyle,Z=C===void 0?!1:C,T=e.ellipsis,P=T===void 0?!0:T,x=e.onClick,z=e.prefixText,v=(0,u.useRef)(null);if(typeof t=="undefined")return null;var U=Z?ee.Z.Link:ee.Z.Text,k=m?Ee()(Number(t)).format(h):M?be(String(t)):t,s=(0,i.jsxs)(U,{onClick:x,ellipsis:P,style:{color:"inherit"},children:[z," ",k||"-"]});return j?(0,i.jsx)(je.Z,{title:c?"\u70B9\u51FB\u590D\u5236":k,children:c?(0,i.jsx)("span",{ref:v,style:{cursor:"pointer"},onClick:function(){if(v.current){var f=window.getSelection(),d=document.createRange();d.selectNodeContents(v.current),f==null||f.removeAllRanges(),f==null||f.addRange(d),f==null||f.toString();var R=document.execCommand("copy");Pe.ZP[R?"success":"error"]("\u590D\u5236".concat(R?"\u6210\u529F":"\u5931\u8D25"))}},children:s}):s}):s}),Ie=o(89380),$=o(58853),te=o(70451),Le=o(54315),Y=o(78234),ae=o(81763),Be=o(96486),le=o.n(Be),y=o(55375),Ze=o(68508),ze=o(57632),Fe=o(73935),V={},Ne=(0,u.memo)(function(n){var e=n.parentRef,t=n.menus,r=(0,u.useState)(!1),c=E()(r,2),l=c[0],h=c[1],p=(0,u.useState)(0),m=E()(p,2),w=m[0],j=m[1],S=(0,u.useState)(0),M=E()(S,2),C=M[0],Z=M[1],T=(0,u.useRef)(null),P=(0,u.useRef)(""),x=(0,u.useState)(0)[1];(0,u.useEffect)(function(){var v=e||null;if(v){var U=function(a){a.preventDefault();var f=v.getBoundingClientRect().top+window.scrollY;h(!0),j(a.clientX),Z(f)},k=function(){h(!1)};return v.addEventListener("contextmenu",U),window.addEventListener("click",k),function(){v.removeEventListener("contextmenu",U),window.removeEventListener("click",k)}}}),(0,u.useEffect)(function(){if(l)T.current=document.createElement("div"),P.current=(0,ze.Z)(),T.current.setAttribute("id",P.current),T.current.setAttribute("class","context-menu-portal"),document.body.appendChild(T.current),x(function(v){return v+1}),V[P.current]=function(){return h(!1)};else try{T.current&&document.body.removeChild(T.current)}catch(v){console.log(v)}},[l]),(0,u.useEffect)(function(){if(l&&T.current){var v=Array.from(document.querySelectorAll(".context-menu-portal"));v.forEach(function(U){var k=U.getAttribute("id")||"";k!==P.current&&U.hasChildNodes()&&V[k]&&typeof V[k]=="function"&&V[k]()})}},[l]);var z={top:C,left:w};return l&&T.current?(0,Fe.createPortal)((0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{style:g()(g()({},z),{},{position:"absolute"}),children:(0,i.jsx)(Ze.Z,{style:{boxShadow:"1px 1px 3px 0px rgba(0,0,0,0.44)"},items:t.map(function(v){return{danger:!1,icon:v.icon,label:v.name,key:v.id,onClick:v.onClick}})})})}),T.current):null}),$e=Ne,se=o(23919),De=o(27704),Ae=o(94184),He=o.n(Ae),Oe=(0,u.memo)(function(n){var e,t=n.row,r=n.rowIndex,c=n.trProps,l=(0,u.useRef)(null),h=(0,$.useModel)("socket"),p=h.socket,m=(0,te.Z)(),w=E()(m,2),j=w[0],S=w[1].toggle,M=(0,$.useModel)("highlight-ids"),C=M.highlightIdsMap,Z=M.setHighlightIdsMap,T=(0,u.useState)(!1),P=E()(T,2),x=P[0],z=P[1],v=(0,u.useState)(""),U=E()(v,2),k=U[0],s=U[1],a=t.id,f=(0,u.useMemo)(function(){var I={id:"highlight_".concat(r),name:"Highlight",icon:(0,i.jsx)(se.Z,{style:{color:y.pS}}),onClick:function(){Z(g()(g()({},C),{},L()({},a,!0))),S()}},F={id:"un_highlight_".concat(r),name:"Cancel Highlight",icon:(0,i.jsx)(se.Z,{style:{color:y.nr}}),onClick:function(){Z(g()(g()({},C),{},L()({},a,!1))),S()}},H=[{id:"remove_".concat(r),name:"Remove",icon:(0,i.jsx)(De.Z,{style:{color:y.AG}}),onClick:function(){p.emit(y.uT,a)}}],X=Object.keys(C).includes(String(a));return H.unshift(X&&Boolean(C[String(a)])?F:I),H},[r,C,a,j]),d=t._blinkRow,R=(d==null||(e=d.current)===null||e===void 0?void 0:e.status)===N.InProgress;return(0,Y.Z)(function(){d&&d.setRowForceUpdate(S)}),(0,u.useEffect)(function(){R&&(z(!0),setTimeout(function(){z(!1),d.handleBlinkEnd()},1e3))},[R]),(0,u.useEffect)(function(){if(x){var I,F;switch(d==null||(I=d.current)===null||I===void 0||(F=I.message)===null||F===void 0?void 0:F.action){case 0:s("blink-row-red");break;case 1:s("blink-row-green");break;case 2:s("blink-row-gray");break;case 3:s("blink-row-yellow");break;default:break}}else s("")},[x]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("tr",g()(g()({},c),{},{className:He()(x?"blink-row":"row-default",k),onTransitionEnd:function(){d.handleBlinkEnd()},ref:l})),(0,i.jsx)($e,{parentRef:l==null?void 0:l.current,menus:f})]})}),Ye=Oe,Ve=(0,u.memo)(function(n){var e=n.row,t=n.rowIndex,r=n.column,c=n.tdProps,l=(0,te.Z)(),h=E()(l,2),p=h[1].toggle;if((0,Y.Z)(function(){r.code&&["currentPrice","lastPrice","trend"].includes(r.code)&&e!==null&&e!==void 0&&e._blinkRow&&e._blinkRow.pushCellForceUpdates("".concat(e.id,"_").concat(r.code),p)}),typeof r.render=="function"&&r.code){var m,w,j=(e==null||(m=e._blinkRow)===null||m===void 0||(w=m.current)===null||w===void 0?void 0:w.message)||{},S=j.currentPrice,M=j.lastPrice,C=j.action;return r.code==="currentPrice"&&typeof S=="number"&&(e.currentPrice=S),r.code==="lastPrice"&&typeof M=="number"&&(e.lastPrice=M),r.code==="trend"&&C&&(e.trend=C),(0,i.jsx)("td",g()(g()({},c),{},{children:r.render(e[r.code],e,t)}))}return(0,i.jsx)("td",g()({},c))}),We=Ve,Xe=o(26713),Ke=o(72269),Qe=o(18662),Ge=(0,u.memo)(function(n){var e=n.onUpdateSwitchChange,t=(0,$.useModel)("socket"),r=t.socket;return(0,i.jsxs)(Xe.Z,{direction:"horizontal",align:"start",children:[(0,i.jsx)(Ke.Z,{defaultChecked:!0,onChange:e,checkedChildren:"Batch Updated",unCheckedChildren:"Without Updated"}),(0,i.jsx)(Qe.ZP,{type:"primary",size:"small",onClick:function(){r.emit(y.BX)},children:"Clear All"})]})}),Je=Ge,ne;(function(n){n[n.Up=0]="Up",n[n.Down=1]="Down",n[n.Stable=2]="Stable"})(ne||(ne={}));var W;(function(n){n.NormalTrading="Normal Trading",n.Suspended="Suspended"})(W||(W={}));var b=o(15623),qe=2e4,_e=function(e){return Array.from({length:e},function(){return{name:b.Random.word(3,8),code:b.Random.id(),currentPrice:b.Random.float(0,1e3,0,2),traderName:b.Random.name(),trend:ne.Stable,status:[W.NormalTrading,W.Suspended][Math.floor(Math.random()*2)]}})};function et(){var n=(0,$.useModel)("socket"),e=n.socket,t=(0,u.useRef)(null),r=function(){t.current=setInterval(function(){e.emit(y.oq)},b.Random.integer(500,1e3))},c=function(){t.current&&clearInterval(t.current)};return(0,Y.Z)(function(){r(),e.on(y.c7,function(l){if(l.total){var h=b.Random.integer(1,10),p=b.Random.integer(0,h/2),m=Math.max(0,h-p);if(console.log("addActionCount",p,"updateActionCount",m),l.total>qe){t.current&&clearInterval(t.current);return}var w=_e(p);for(w.forEach(function(C){return e.emit(y.Cw,C)});m;){m-=1;var j=b.Random.integer(0,20),S=l.data[j],M=b.Random.integer(0,2)===0;e.emit(y.y8,g()(g()({},S),{},{currentPrice:M?S.currentPrice:b.Random.float(0,1e3,0,2)}))}}})}),(0,ae.Z)(function(){t.current&&clearInterval(t.current)}),{stopLoop:c,startLoop:r}}var tt=(0,u.memo)(function(){var n=(0,$.useModel)("trading-list"),e=n.tradingList,t=n.setTradingList,r=n.loading,c=n.total,l=(0,$.useModel)("highlight-ids"),h=l.highlightIdsMap,p=(0,$.useModel)("socket"),m=p.socket,w=et(),j=w.stopLoop,S=w.startLoop,M=(0,te.Z)(),C=E()(M,2),Z=C[1].toggle,T=(0,u.useRef)(null),P=(0,Le.Z)(T),x=(P==null?void 0:P.width)||0;(0,Y.Z)(function(){m.emit(y.oq)}),(0,ae.Z)(function(){m.off(y.c7)});var z=(0,u.useMemo)(function(){return[x>500&&{name:"Trade ID",code:"id",width:70,render:function(a){return(0,i.jsx)(B,{value:a,copyable:!0})}},x>600&&{name:"Trade Name",code:"name",width:100,render:function(a){return(0,i.jsx)(B,{value:a,copyable:!0})}},{name:"Trade Code",code:"code",render:function(a){return(0,i.jsx)(B,{value:a})}},{name:"Current Price",code:"currentPrice",render:function(a){return a===-1?"-":(0,i.jsx)(B,{prefixText:"$",value:a,isNum:!0})}},x>450&&{name:"Last Price",code:"lastPrice",render:function(a){return a===-1?"-":(0,i.jsx)(B,{prefixText:"$",value:a,isNum:!0})}},x>800&&{name:"Trader Name",code:"traderName",render:function(a){return(0,i.jsx)(B,{value:a})}},{name:"Trend",code:"trend",width:60,render:function(a,f){var d,R,I,F=f==null||(d=f._blinkRow)===null||d===void 0||(R=d.current)===null||R===void 0||(I=R.message)===null||I===void 0?void 0:I.action,H=typeof F=="undefined"?a:F,X=[_.UpIcon,_.DownIcon,_.StableIcon][H],K=[y.b1,y.zY,Boolean(h[f.id])?"white":y.LL][H];return X?(0,i.jsx)(X,{size:28,color:K}):null}},x>1e3&&{name:"Updated Time",code:"updatedTime",width:150,render:function(a){return a===0?"-":(0,i.jsx)(B,{value:a,isTime:!0})}},x>1e3&&{name:"Created Time",code:"createdTime",width:150,render:function(a){return(0,i.jsx)(B,{value:a,isTime:!0})}},x>900&&{name:"Trade Status",code:"status"}].filter(Boolean)},[x]);(0,u.useEffect)(function(){Z()},[h]),(0,u.useEffect)(function(){return m.on(y.x4,function(s){if(!(!s||!s.action||!s.data)){var a=s.action,f=s.data;switch(f.forEach(function(d){d._blinkRow=ie(d.id)}),a){case"add":t(le().uniqBy([].concat(D()(f),D()(e)),"id")),requestAnimationFrame(function(){f.forEach(function(d){var R;(R=d._blinkRow)===null||R===void 0||R.append({action:3})})});break;case"update":f.forEach(function(d){var R;(R=d._blinkRow)===null||R===void 0||R.append({action:d.trend,currentPrice:d.currentPrice,lastPrice:d.lastPrice})});break;default:break}}}),function(){m.off(y.x4)}},[e]);var v=(0,u.useCallback)(function(s){return{style:g()({},Boolean(h[s.id])?{"--bgcolor":"transparent","--color":"transparent","--hover-bgcolor":"rgba(0,0,255,0.3)",backgroundColor:"".concat(y.pS),color:"white"}:{backgroundColor:"transparent"})}},[h]),U=(0,i.jsxs)(ee.Z.Text,{children:["Total Count: ",c]},"total-count"),k=(0,u.useMemo)(function(){var s=le().clone(e).map(function(a){return a._blinkRow=ie(a.id),a});return s},[e]);return(0,i.jsx)(Se.Z,{spinning:x===0||r,children:(0,i.jsxs)(q._z,{extra:U,footer:[U],extraContent:(0,i.jsx)(Je,{onUpdateSwitchChange:function(a){return a?S():j()}}),style:{opacity:x===0?0:1},children:[(0,i.jsx)("div",{ref:T,children:(0,i.jsx)(pe.B,{dataSource:k,columns:z,primaryKey:"id",getRowProps:v,style:{height:600},components:{Row:Ye,Cell:We,EmptyContent:function(){return(0,i.jsx)(Me.Z,{description:"Trading data is empty"})}}})}),(0,i.jsx)(Ie.Z,{direction:"vertical",size:50}),(0,i.jsx)(ke.Z.BackTop,{style:{bottom:80}})]})})}),nt=tt}}]);
